from module import *
import csv
import pathlib
import ROOT
ROOT.gInterpreter.Declare('#include "helper.h"')
from itertools import product, pairwise
import numpy as np
import sys


class trigger_rew(module):
   
    def __init__(self):

        # runs = []
        # lumis = []
        # lumivals = []

        # dict={}

        # filename = '/scratch1/ptscale/2016lumibyls.csv'
        # with open(filename) as lumicsv:
        #     reader = csv.reader(lumicsv)
        #     for row in reader:
        #         if row[0][0]=="#":
        #             continue
                
        #         run, _ = row[0].split(":")
        #         lumi, _ = row[1].split(":")
        #         lumival = row[6]

        #         run = int(run)
        #         lumi = int(lumi)
        #         lumival = float(lumival)

        #         runs.append(run)
        #         lumis.append(lumi)
        #         lumivals.append(lumival)

        #         dict[(run,lumi)]=lumival

        # dict_presc={}

        # # paths = ['HLT_Dimuon0er16_Jpsi_NoOS_NoVertexing','HLT_Dimuon20_Jpsi','HLT_DoubleMu4_JpsiTrk_Displaced','HLT_Mu7p5_Track2_Jpsi','HLT_Mu7p5_Track3p5_Jpsi']

        paths = ['HLT_Dimuon20_Jpsi','HLT_DoubleMu4_JpsiTrk_Displaced','HLT_Dimuon0er16_Jpsi_NoOS_NoVertexing','HLT_Mu7p5_Track2_Jpsi','HLT_Mu7p5_Track3p5_Jpsi','HLT_Dimuon0_Jpsi_Muon','HLT_Dimuon0er16_Jpsi_NoVertexing','HLT_Dimuon10_Jpsi_Barrel','HLT_Dimuon16_Jpsi','HLT_DoubleMu4_3_Jpsi_Displaced','HLT_Mu7p5_Track7_Jpsi']

        # filename = '/scratch1/ptscale/HLTall.csv'
        # with open(filename) as lumicsv:
        #     reader = csv.reader(lumicsv)
        #     for row in reader:
        #         if row[0][0]=="#":
        #             continue
                
        #         run_presc = row[0]
        #         lumi_presc = row[1]
        #         prescval = row[3]
        #         path = row[4]

        #         found = False
        #         for p in paths:
        #             if p in path: 
        #                 found = True
        #                 mypath = p
        #         if found==False: continue
        #         #only takes runs filtered by postVFP golden json
        #         if not int(run_presc) in runs: continue

        #         if lumi_presc == 'None': 
        #             continue
                
        #         run_presc = int(run_presc)
        #         lumi_presc = int(lumi_presc)
        #         prescval = int(prescval)

        #         if not (run_presc,lumi_presc) in dict_presc:
        #             dict_presc[(run_presc,lumi_presc)]=[]
        #         dict_presc[(run_presc,lumi_presc)].append((prescval,mypath))

        # for keys in dict_presc:
        #     if keys[0] == 279694:
        #         print(keys,dict_presc[keys])

        # #now complete the other dictionary
        # dict_new ={}

        # for runtuple in dict:
        #     lumival = dict[runtuple]
        #     run,lumi = runtuple[0],runtuple[1]

        #     dict_new[runtuple]={}

        #     for runtuple_presc in dict_presc:
        #         run_presc = runtuple_presc[0]
        #         if not run_presc==run: continue

        #         lumi_presc = runtuple_presc[1]

        #         values = dict_presc[runtuple_presc]

        #         if lumi>=lumi_presc:
        #             dict_new[(run,lumi)]['lumival']=lumival
        #             dict_new[(run,lumi)]['paths']=values

        # # prepare pre-computed map

        # #generate all possible combinations

        combs=list(product("01",repeat=11))
        # weight = np.zeros(len(combs))

        # lumitot = 0.
        # for key in dict_new:
        #     lumitot += dict_new[key]['lumival']

        # print(lumitot)

        # for icomb,comb in enumerate(combs):
        #     wtemp = 0.
        #     for key in dict_new:
        #         lumival = dict_new[key]['lumival']
        #         paths =  dict_new[key]['paths']
        #         prod = 1.
        #         # if(key_next[0]==key[0]): #sum inside same run
        #         for ipath,path in enumerate(paths):
        #             if path[0]==0: 
        #                 prod*=1.
        #             else:
        #                 prod*=float(comb[ipath])*(1.-1./path[0]) + (1.-float(comb[ipath]))
        #         wtemp+=lumival/lumitot *(1-prod)
        #     weight[icomb]+=wtemp

        combs_str = []
        for comb in combs:
            mystring = ""
            for c in comb:
                mystring+=c
            combs_str.append(mystring)
        
        weight = np.array([0.,0.10652881 ,0.18826043 ,0.29403318 ,0.54313855 ,0.56181878
 ,0.63958967 ,0.65826003 ,0.32301985 ,0.39427085 ,0.36447272 ,0.43501265
 ,0.70893209 ,0.71930939 ,0.70954256 ,0.71991003 ,0.06485254 ,0.11334681
 ,0.25017175 ,0.29794091 ,0.54567911 ,0.56428869 ,0.64074675 ,0.65934645
 ,0.3661046  ,0.39663287 ,0.40699271 ,0.43684039 ,0.7095512  ,0.71985784
 ,0.71016167 ,0.72045848 ,0.07979574 ,0.18369682 ,0.26670139 ,0.36987187
 ,0.61941754 ,0.63654229 ,0.71512373 ,0.73224612 ,0.40065107 ,0.46977581
 ,0.44145545 ,0.50989416 ,0.78421201 ,0.79310879 ,0.78444598 ,0.79334041
 ,0.14381434 ,0.19048037 ,0.3277957  ,0.3737613  ,0.62194805 ,0.63900235
 ,0.7162764  ,0.73332834 ,0.44322972 ,0.47212673 ,0.48347334 ,0.51171406
 ,0.78482837 ,0.79365471 ,0.78506234 ,0.79388633 ,0.20163285 ,0.30645234
 ,0.38857561 ,0.49266286 ,0.74011177 ,0.75753353 ,0.83585476 ,0.85327252
 ,0.52232384 ,0.59205473 ,0.56316501 ,0.63220824 ,0.90448066 ,0.91363168
 ,0.90475111 ,0.91389815 ,0.26570667 ,0.31272382 ,0.44972514 ,0.49604022
 ,0.74213877 ,0.75949008 ,0.83650392 ,0.85385123 ,0.56474312 ,0.59389601
 ,0.60502353 ,0.6335185  ,0.90459591 ,0.91367648 ,0.90486636 ,0.91394295
 ,0.23704207 ,0.3401199  ,0.42287392 ,0.52523966 ,0.7722675  ,0.78900922
 ,0.86750306 ,0.88424346 ,0.55581839 ,0.62430141 ,0.5962492  ,0.66406433
 ,0.935878   ,0.94441889 ,0.93600665 ,0.94454622 ,0.30028817 ,0.34635958
 ,0.48321252 ,0.52860127 ,0.77428687 ,0.79095835 ,0.86815022 ,0.88482038
 ,0.59773594 ,0.62613409 ,0.63760996 ,0.6653692  ,0.93599289 ,0.94446356
 ,0.93612154 ,0.94459089 ,0.40851499 ,0.51302463 ,0.59538748 ,0.69916566
 ,0.70045965 ,0.71757233 ,0.7961325  ,0.81324197 ,0.72594902 ,0.79537084
 ,0.76672006 ,0.835455   ,0.86489625 ,0.87373899 ,0.86509671 ,0.87393624
 ,0.47185863 ,0.51856592 ,0.65580682 ,0.70181283 ,0.70272957 ,0.71977181
 ,0.79702459 ,0.81406362 ,0.76766257 ,0.7965064  ,0.80787285 ,0.83605953
 ,0.86525379 ,0.87402608 ,0.86545425 ,0.87422334 ,0.43503609 ,0.53793145
 ,0.62081858 ,0.7230024  ,0.72471197 ,0.74127177 ,0.81989832 ,0.83645736
 ,0.75059151 ,0.81889261 ,0.79097311 ,0.85860688 ,0.88841047 ,0.89677001
 ,0.88849006 ,0.89684884 ,0.49755555 ,0.54344449 ,0.68043054 ,0.72563737
 ,0.7269733  ,0.74346286 ,0.82078744 ,0.83727624 ,0.79180662 ,0.82002286
 ,0.83163143 ,0.85920932 ,0.8887667  ,0.897056   ,0.88884629 ,0.89713483
 ,0.53933539 ,0.64264437 ,0.72503778 ,0.827636   ,0.82851061 ,0.84486793
 ,0.92361712 ,0.93997444 ,0.85482842 ,0.92323498 ,0.89513018 ,0.96287017
 ,0.99188318 ,1.         ,0.99188318 ,1.         ,0.60212839 ,0.64786618
 ,0.78492329 ,0.82997974 ,0.83048484 ,0.84677193 ,0.92421914 ,0.94050623
 ,0.89610236 ,0.92407512 ,0.93584733 ,0.9631825  ,0.99195341 ,1.
 ,0.99195341 ,1.         ,0.54210312 ,0.64426704 ,0.72684412 ,0.82831432
 ,0.82914864 ,0.84541413 ,0.92389164 ,0.94015713 ,0.85585069 ,0.92360051
 ,0.89588661 ,0.96298652 ,0.99190798 ,1.         ,0.99190798 ,1.
 ,0.60407679 ,0.64946191 ,0.78592696 ,0.83064705 ,0.83111541 ,0.84731089
 ,0.92449181 ,0.94068728 ,0.89662921 ,0.92443648 ,0.93611226 ,0.96329789
 ,0.991978   ,1.         ,0.991978   ,1.         ,0.58163432 ,0.65686353
 ,0.72839421 ,0.80362341 ,0.88367377 ,0.89194051 ,0.97951169 ,0.98777843
 ,0.7657436  ,0.80593278 ,0.7657436  ,0.80593278 ,0.98790285 ,0.98790285
 ,0.98790285 ,0.98790285 ,0.6421087  ,0.65992483 ,0.78649258 ,0.8043087
 ,0.88509508 ,0.89336181 ,0.97954952 ,0.98781625 ,0.80660923 ,0.80660923
 ,0.80660923 ,0.80660923 ,0.98794029 ,0.98794029 ,0.98794029 ,0.98794029
 ,0.58400458 ,0.65825273 ,0.73006055 ,0.8043087  ,0.88414527 ,0.89234477
 ,0.97961675 ,0.98781625 ,0.76691037 ,0.80660923 ,0.76691037 ,0.80660923
 ,0.98794029 ,0.98794029 ,0.98794029 ,0.98794029 ,0.64367042 ,0.6612986
 ,0.7873633  ,0.80499148 ,0.88556081 ,0.89376031 ,0.97965446 ,0.98785396
 ,0.80728321 ,0.80728321 ,0.80728321 ,0.80728321 ,0.9879776  ,0.9879776
 ,0.9879776  ,0.9879776  ,0.58334671 ,0.65825273 ,0.72940268 ,0.8043087
 ,0.88410427 ,0.89234477 ,0.97957575 ,0.98781625 ,0.76656143 ,0.80660923
 ,0.76656143 ,0.80660923 ,0.98794029 ,0.98794029 ,0.98794029 ,0.98794029
 ,0.64357732 ,0.6612986  ,0.7872702  ,0.80499148 ,0.88551981 ,0.89376031
 ,0.97961346 ,0.98785396 ,0.80728321 ,0.80728321 ,0.80728321 ,0.80728321
 ,0.9879776  ,0.9879776  ,0.9879776  ,0.9879776  ,0.58570544 ,0.65963504
 ,0.73106188 ,0.80499148 ,0.88457398 ,0.89274745 ,0.97968049 ,0.98785396
 ,0.76772389 ,0.80728321 ,0.76772389 ,0.80728321 ,0.9879776  ,0.9879776
 ,0.9879776  ,0.9879776  ,0.64513112 ,0.66266558 ,0.7881373  ,0.80567176
 ,0.88598377 ,0.89415724 ,0.97971807 ,0.98789155 ,0.80795472 ,0.80795472
 ,0.80795472 ,0.80795472 ,0.9880148  ,0.9880148  ,0.9880148  ,0.9880148
 ,0.77903801 ,0.85394403 ,0.92509398 ,1.         ,0.89628802 ,0.90452852
 ,0.9917595  ,1.         ,0.95995221 ,1.         ,0.95995221 ,1.
 ,1.         ,1.         ,1.         ,1.         ,0.83858584 ,0.85630712
 ,0.98227872 ,1.         ,0.89766585 ,0.90590635 ,0.9917595  ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,0.78071396 ,0.85464356 ,0.9260704  ,1.
 ,0.89672002 ,0.90489349 ,0.99182653 ,1.         ,0.96044068 ,1.
 ,0.96044068 ,1.         ,1.         ,1.         ,1.         ,1.
 ,0.83945936 ,0.85699382 ,0.98246554 ,1.         ,0.89809222 ,0.90626569
 ,0.99182653 ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,0.7800591  ,0.85464356
 ,0.92541554 ,1.         ,0.89667914 ,0.90489349 ,0.99178565 ,1.
 ,0.96009307 ,1.         ,0.96009307 ,1.         ,1.         ,1.
 ,1.         ,1.         ,0.83936676 ,0.85699382 ,0.98237294 ,1.
 ,0.89805135 ,0.90626569 ,0.99178565 ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,0.7817261  ,0.85533874 ,0.92638736 ,1.         ,0.89710948 ,0.905257
 ,0.99185247 ,1.         ,0.96057971 ,1.         ,0.96057971 ,1.
 ,1.         ,1.         ,1.         ,1.         ,0.84023491 ,0.85767626
 ,0.98255865 ,1.         ,0.89847608 ,0.90662361 ,0.99185247 ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,0.54831383 ,0.62279602 ,0.62985756 ,0.70433142
 ,0.72547333 ,0.73415086 ,0.77404034 ,0.78270958 ,0.72107681 ,0.77823932
 ,0.74520462 ,0.80235884 ,0.82526215 ,0.83393139 ,0.82579191 ,0.83445289
 ,0.60863596 ,0.62531839 ,0.68932352 ,0.70599762 ,0.72655404 ,0.73517314
 ,0.77464779 ,0.78325861 ,0.76221697 ,0.77889107 ,0.78605825 ,0.80272406
 ,0.82542176 ,0.83403258 ,0.82595152 ,0.83455409 ,0.61392196 ,0.68630937
 ,0.69483238 ,0.76721754 ,0.78944162 ,0.79687757 ,0.8375516  ,0.84498532
 ,0.78552997 ,0.84090825 ,0.80920177 ,0.86457781 ,0.88861769 ,0.89605141
 ,0.88883898 ,0.89627048 ,0.67343693 ,0.68882196 ,0.7534946  ,0.76887739
 ,0.790519   ,0.79789671 ,0.83815718 ,0.84553265 ,0.8261744  ,0.8415572
 ,0.84956135 ,0.86494191 ,0.88877682 ,0.89615229 ,0.88899811 ,0.89637136
 ,0.64539766 ,0.71865045 ,0.72635794 ,0.79960673 ,0.82124042 ,0.8289727
 ,0.86939992 ,0.8771282  ,0.81717046 ,0.87319533 ,0.84089177 ,0.89691265
 ,0.92036481 ,0.92809309 ,0.92063526 ,0.92835956 ,0.70537782 ,0.72106095
 ,0.78548536 ,0.80116448 ,0.82221661 ,0.82989064 ,0.86990431 ,0.87757434
 ,0.85806338 ,0.8737425  ,0.88149984 ,0.89717496 ,0.92042306 ,0.92809309
 ,0.92069351 ,0.92835956 ,0.67865403 ,0.75045243 ,0.75915102 ,0.83094809
 ,0.85303251 ,0.86015635 ,0.90090302 ,0.90802554 ,0.84944431 ,0.90432027
 ,0.87287816 ,0.9277528  ,0.95171298 ,0.95883551 ,0.95184163 ,0.95896284
 ,0.7378309  ,0.7528535  ,0.81747855 ,0.83249982 ,0.8540057  ,0.86107147
 ,0.90140586 ,0.9084703  ,0.8898437  ,0.90486497 ,0.91299435 ,0.9280143
 ,0.95177106 ,0.95883551 ,0.9518997  ,0.95896284 ,0.6568109  ,0.72946972
 ,0.73761928 ,0.81027647 ,0.83274848 ,0.83988916 ,0.88075667 ,0.88789573
 ,0.8285184  ,0.88395167 ,0.85208841 ,0.90752006 ,0.93180741 ,0.93894646
 ,0.93192715 ,0.93906459 ,0.71687766 ,0.73196681 ,0.7968333  ,0.81192082
 ,0.83381051 ,0.84089295 ,0.8813469  ,0.88842771 ,0.86949765 ,0.88458517
 ,0.89278281 ,0.9078687  ,0.93195124 ,0.93903204 ,0.93207098 ,0.93915016
 ,0.67037656 ,0.74195191 ,0.75081143 ,0.82238614 ,0.84493888 ,0.85184036
 ,0.89274746 ,0.89964831 ,0.84119106 ,0.89584466 ,0.86456298 ,0.91921594
 ,0.943643   ,0.95054385 ,0.94370991 ,0.95061013 ,0.72963977 ,0.74443932
 ,0.80922529 ,0.82402421 ,0.84599765 ,0.85284106 ,0.89333587 ,0.90017865
 ,0.88167651 ,0.89647542 ,0.90476523 ,0.91956351 ,0.94378639 ,0.95062917
 ,0.9438533  ,0.95069544 ,0.71993633 ,0.79187278 ,0.80030386 ,0.87224032
 ,0.89475012 ,0.90144857 ,0.94249158 ,0.94919003 ,0.89081299 ,0.9456125
 ,0.91411779 ,0.9689173  ,0.99330155 ,1.         ,0.99330155 ,1.
 ,0.77967797 ,0.79427385 ,0.85919617 ,0.87379205 ,0.89572332 ,0.90236369
 ,0.94299442 ,0.9496348  ,0.93156131 ,0.94615719 ,0.95458291 ,0.96917879
 ,0.99335962 ,1.         ,0.99335962 ,1.         ,0.72157239 ,0.79264896
 ,0.80162121 ,0.87269778 ,0.89507111 ,0.90174911 ,0.94266649 ,0.94934449
 ,0.89161326 ,0.945854   ,0.91477398 ,0.96901473 ,0.993322   ,1.
 ,0.993322   ,1.         ,0.78051431 ,0.79504065 ,0.85971718 ,0.87424352
 ,0.89604131 ,0.90266142 ,0.94316778 ,0.94978788 ,0.9318699  ,0.94639623
 ,0.95474907 ,0.96927541 ,0.9933799  ,1.         ,0.9933799  ,1.
 ,0.88517327 ,0.94258636 ,0.94258692 ,1.         ,0.95196501 ,0.95196501
 ,1.         ,1.         ,0.95981082 ,1.         ,0.95981082 ,1.
 ,1.         ,1.         ,1.         ,1.         ,0.943156   ,0.943156
 ,1.         ,1.         ,0.95243827 ,0.95243827 ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,0.88614211 ,0.94276208 ,0.94338003 ,1.
 ,0.952112   ,0.952112   ,1.         ,1.         ,0.96030114 ,1.
 ,0.96030114 ,1.         ,1.         ,1.         ,1.         ,1.
 ,0.94332997 ,0.94332997 ,1.         ,1.         ,0.95258381 ,0.95258381
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,0.88557734 ,0.94276208
 ,0.94281526 ,1.         ,0.952112   ,0.952112   ,1.         ,1.
 ,0.95995221 ,1.         ,0.95995221 ,1.         ,1.         ,1.
 ,1.         ,1.         ,0.94332997 ,0.94332997 ,1.         ,1.
 ,0.95258381 ,0.95258381 ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,0.88654212 ,0.94293726 ,0.94360486 ,1.         ,0.95225854 ,0.95225854
 ,1.         ,1.         ,0.96044068 ,1.         ,0.96044068 ,1.
 ,1.         ,1.         ,1.         ,1.         ,0.94350341 ,0.94350341
 ,1.         ,1.         ,0.95272889 ,0.95272889 ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,0.88557734 ,0.94276208 ,0.94281526 ,1.
 ,0.952112   ,0.952112   ,1.         ,1.         ,0.95995221 ,1.
 ,0.95995221 ,1.         ,1.         ,1.         ,1.         ,1.
 ,0.94332997 ,0.94332997 ,1.         ,1.         ,0.95258381 ,0.95258381
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,0.88654212 ,0.94293726
 ,0.94360486 ,1.         ,0.95225854 ,0.95225854 ,1.         ,1.
 ,0.96044068 ,1.         ,0.96044068 ,1.         ,1.         ,1.
 ,1.         ,1.         ,0.94350341 ,0.94350341 ,1.         ,1.
 ,0.95272889 ,0.95272889 ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,0.88597987 ,0.94293726 ,0.9430426  ,1.         ,0.95225854 ,0.95225854
 ,1.         ,1.         ,0.96009307 ,1.         ,0.96009307 ,1.
 ,1.         ,1.         ,1.         ,1.         ,0.94350341 ,0.94350341
 ,1.         ,1.         ,0.95272889 ,0.95272889 ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,0.88694062 ,0.9431119  ,0.94382871 ,1.
 ,0.95240462 ,0.95240462 ,1.         ,1.         ,0.96057971 ,1.
 ,0.96057971 ,1.         ,1.         ,1.         ,1.         ,1.
 ,0.94367631 ,0.94367631 ,1.         ,1.         ,0.95287353 ,0.95287353
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,0.79033152 ,0.83596512
 ,0.79033152 ,0.83596512 ,0.97192224 ,0.97878348 ,0.97192224 ,0.97878348
 ,0.80978389 ,0.83722599 ,0.80978389 ,0.83722599 ,0.9788487  ,0.9788487
 ,0.9788487  ,0.9788487  ,0.82342982 ,0.83645682 ,0.82342982 ,0.83645682
 ,0.9719874  ,0.97884864 ,0.9719874  ,0.97884864 ,0.83771385 ,0.83771385
 ,0.83771385 ,0.83771385 ,0.97891366 ,0.97891366 ,0.97891366 ,0.97891366
 ,0.79125701 ,0.83645682 ,0.79125701 ,0.83645682 ,0.97204329 ,0.97884864
 ,0.97204329 ,0.97884864 ,0.81052906 ,0.83771385 ,0.81052906 ,0.83771385
 ,0.97891366 ,0.97891366 ,0.97891366 ,0.97891366 ,0.82404479 ,0.83694704
 ,0.82404479 ,0.83694704 ,0.97210825 ,0.9789136  ,0.97210825 ,0.9789136
 ,0.83820024 ,0.83820024 ,0.83820024 ,0.83820024 ,0.97897842 ,0.97897842
 ,0.97897842 ,0.97897842 ,0.81227751 ,0.85774788 ,0.81227751 ,0.85774788
 ,0.99309487 ,0.99993434 ,0.99309487 ,0.99993434 ,0.83158197 ,0.85893946
 ,0.83158197 ,0.85893946 ,0.99993455 ,0.99993455 ,0.99993455 ,0.99993455
 ,0.84520824 ,0.85817265 ,0.84520824 ,0.85817265 ,0.99309502 ,0.99993449
 ,0.99309502 ,0.99993449 ,0.8593606  ,0.8593606  ,0.8593606  ,0.8593606
 ,0.9999347  ,0.9999347  ,0.9999347  ,0.9999347  ,0.81313448 ,0.85817265
 ,0.81313448 ,0.85817265 ,0.99315074 ,0.99993449 ,0.99315074 ,0.99993449
 ,0.83225962 ,0.8593606  ,0.83225962 ,0.8593606  ,0.9999347  ,0.9999347
 ,0.9999347  ,0.9999347  ,0.84575587 ,0.85859614 ,0.84575587 ,0.85859614
 ,0.99315088 ,0.99993464 ,0.99315088 ,0.99993464 ,0.85978048 ,0.85978048
 ,0.85978048 ,0.85978048 ,0.99993485 ,0.99993485 ,0.99993485 ,0.99993485
 ,0.93662478 ,0.98209516 ,0.93662478 ,0.98209516 ,0.97542657 ,0.98226604
 ,0.97542657 ,0.98226604 ,0.95479265 ,0.98215014 ,0.95479265 ,0.98215014
 ,0.98232049 ,0.98232049 ,0.98232049 ,0.98232049 ,0.96918574 ,0.98215014
 ,0.96918574 ,0.98215014 ,0.97548102 ,0.98232049 ,0.97548102 ,0.98232049
 ,0.98220495 ,0.98220495 ,0.98220495 ,0.98220495 ,0.98237477 ,0.98237477
 ,0.98237477 ,0.98237477 ,0.93711198 ,0.98215014 ,0.93711198 ,0.98215014
 ,0.97553673 ,0.98232049 ,0.97553673 ,0.98232049 ,0.95510397 ,0.98220495
 ,0.95510397 ,0.98220495 ,0.98237477 ,0.98237477 ,0.98237477 ,0.98237477
 ,0.96936469 ,0.98220495 ,0.96936469 ,0.98220495 ,0.97559102 ,0.98237477
 ,0.97559102 ,0.98237477 ,0.9822596  ,0.9822596  ,0.9822596  ,0.9822596
 ,0.98242889 ,0.98242889 ,0.98242889 ,0.98242889 ,0.95469219 ,1.
 ,0.95469219 ,1.         ,0.99318223 ,1.         ,0.99318223 ,1.
 ,0.97272686 ,1.         ,0.97272686 ,1.         ,1.         ,1.
 ,1.         ,1.         ,0.98709784 ,1.         ,0.98709784 ,1.
 ,0.99318223 ,1.         ,0.99318223 ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,0.95512283 ,1.         ,0.95512283 ,1.         ,0.99323777 ,1.
 ,0.99323777 ,1.         ,0.97298257 ,1.         ,0.97298257 ,1.
 ,1.         ,1.         ,1.         ,1.         ,0.98722137 ,1.
 ,0.98722137 ,1.         ,0.99323777 ,1.         ,0.99323777 ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,0.83332703 ,0.8787974  ,0.83332703 ,0.8787974
 ,0.99310295 ,0.99994242 ,0.99310295 ,0.99994242 ,0.8524426  ,0.87980009
 ,0.8524426  ,0.87980009 ,0.9999426  ,0.9999426  ,0.9999426  ,0.9999426
 ,0.86619443 ,0.87915884 ,0.86619443 ,0.87915884 ,0.99310308 ,0.99994255
 ,0.99310308 ,0.99994255 ,0.88015848 ,0.88015848 ,0.88015848 ,0.88015848
 ,0.99994273 ,0.99994273 ,0.99994273 ,0.99994273 ,0.83412067 ,0.87915884
 ,0.83412067 ,0.87915884 ,0.99315879 ,0.99994255 ,0.99315879 ,0.99994255
 ,0.8530575  ,0.88015848 ,0.8530575  ,0.88015848 ,0.99994273 ,0.99994273
 ,0.99994273 ,0.99994273 ,0.86667892 ,0.87951919 ,0.86667892 ,0.87951919
 ,0.99315892 ,0.99994268 ,0.99315892 ,0.99994268 ,0.88051579 ,0.88051579
 ,0.88051579 ,0.88051579 ,0.99994286 ,0.99994286 ,0.99994286 ,0.99994286
 ,0.83385103 ,0.87915884 ,0.83385103 ,0.87915884 ,0.99312478 ,0.99994255
 ,0.99312478 ,0.99994255 ,0.85288534 ,0.88015848 ,0.85288534 ,0.88015848
 ,0.99994273 ,0.99994273 ,0.99994273 ,0.99994273 ,0.86661703 ,0.87951919
 ,0.86661703 ,0.87951919 ,0.99312491 ,0.99994268 ,0.99312491 ,0.99994268
 ,0.88051579 ,0.88051579 ,0.88051579 ,0.88051579 ,0.99994286 ,0.99994286
 ,0.99994286 ,0.99994286 ,0.83464202 ,0.87951919 ,0.83464202 ,0.87951919
 ,0.99318045 ,0.99994268 ,0.99318045 ,0.99994268 ,0.85349836 ,0.88051579
 ,0.85349836 ,0.88051579 ,0.99994286 ,0.99994286 ,0.99994286 ,0.99994286
 ,0.86709982 ,0.87987845 ,0.86709982 ,0.87987845 ,0.99318058 ,0.99994281
 ,0.99318058 ,0.99994281 ,0.88087203 ,0.88087203 ,0.88087203 ,0.88087203
 ,0.99994299 ,0.99994299 ,0.99994299 ,0.99994299 ,0.95469219 ,1.
 ,0.95469219 ,1.         ,0.99318223 ,1.         ,0.99318223 ,1.
 ,0.97272686 ,1.         ,0.97272686 ,1.         ,1.         ,1.
 ,1.         ,1.         ,0.98709784 ,1.         ,0.98709784 ,1.
 ,0.99318223 ,1.         ,0.99318223 ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,0.95512283 ,1.         ,0.95512283 ,1.         ,0.99323777 ,1.
 ,0.99323777 ,1.         ,0.97298257 ,1.         ,0.97298257 ,1.
 ,1.         ,1.         ,1.         ,1.         ,0.98722137 ,1.
 ,0.98722137 ,1.         ,0.99323777 ,1.         ,0.99323777 ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,0.9548541  ,1.         ,0.9548541  ,1.
 ,0.99320386 ,1.         ,0.99320386 ,1.         ,0.97281096 ,1.
 ,0.97281096 ,1.         ,1.         ,1.         ,1.         ,1.
 ,0.98715974 ,1.         ,0.98715974 ,1.         ,0.99320386 ,1.
 ,0.99320386 ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,0.95528317 ,1.
 ,0.95528317 ,1.         ,0.99325922 ,1.         ,0.99325922 ,1.
 ,0.97306587 ,1.         ,0.97306587 ,1.         ,1.         ,1.
 ,1.         ,1.         ,0.98728266 ,1.         ,0.98728266 ,1.
 ,0.99325922 ,1.         ,0.99325922 ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,0.9673934  ,1.         ,0.9673934  ,1.         ,1.         ,1.
 ,1.         ,1.         ,0.97255789 ,1.         ,0.97255789 ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,0.96770244 ,1.         ,0.96770244 ,1.
 ,1.         ,1.         ,1.         ,1.         ,0.9728152  ,1.
 ,0.9728152  ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,0.96749403 ,1.
 ,0.96749403 ,1.         ,1.         ,1.         ,1.         ,1.
 ,0.97264251 ,1.         ,0.97264251 ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,0.9678021  ,1.         ,0.9678021  ,1.         ,1.         ,1.
 ,1.         ,1.         ,0.97289902 ,1.         ,0.97289902 ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,0.96749403 ,1.         ,0.96749403 ,1.
 ,1.         ,1.         ,1.         ,1.         ,0.97264251 ,1.
 ,0.97264251 ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,0.9678021  ,1.
 ,0.9678021  ,1.         ,1.         ,1.         ,1.         ,1.
 ,0.97289902 ,1.         ,0.97289902 ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,0.96759435 ,1.         ,0.96759435 ,1.         ,1.         ,1.
 ,1.         ,1.         ,0.97272686 ,1.         ,0.97272686 ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,0.96790146 ,1.         ,0.96790146 ,1.
 ,1.         ,1.         ,1.         ,1.         ,0.97298257 ,1.
 ,0.97298257 ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,0.96749403 ,1.
 ,0.96749403 ,1.         ,1.         ,1.         ,1.         ,1.
 ,0.97264251 ,1.         ,0.97264251 ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,0.9678021  ,1.         ,0.9678021  ,1.         ,1.         ,1.
 ,1.         ,1.         ,0.97289902 ,1.         ,0.97289902 ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,0.96759435 ,1.         ,0.96759435 ,1.
 ,1.         ,1.         ,1.         ,1.         ,0.97272686 ,1.
 ,0.97272686 ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,0.96790146 ,1.
 ,0.96790146 ,1.         ,1.         ,1.         ,1.         ,1.
 ,0.97298257 ,1.         ,0.97298257 ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,0.96759435 ,1.         ,0.96759435 ,1.         ,1.         ,1.
 ,1.         ,1.         ,0.97272686 ,1.         ,0.97272686 ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,0.96790146 ,1.         ,0.96790146 ,1.
 ,1.         ,1.         ,1.         ,1.         ,0.97298257 ,1.
 ,0.97298257 ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,0.96769436 ,1.
 ,0.96769436 ,1.         ,1.         ,1.         ,1.         ,1.
 ,0.97281096 ,1.         ,0.97281096 ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,0.96800051 ,1.         ,0.96800051 ,1.         ,1.         ,1.
 ,1.         ,1.         ,0.97306587 ,1.         ,0.97306587 ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.         ,1.         ,1.         ,1.         ,1.
 ,1.         ,1.        ])
        self.lumihelper = ROOT.Helper(combs_str, list(weight))

    def run(self,d):

        self.d=d
        # self.d=d.Define("tgrweight",self.lumihelper,['HLT_DoubleMu4_JpsiTrk_Displaced','HLT_Dimuon0er16_Jpsi_NoVertexing','HLT_Dimuon0_Jpsi_Muon','HLT_Dimuon20_Jpsi','HLT_DoubleMu4_3_Jpsi_Displaced','HLT_Dimuon16_Jpsi','HLT_Dimuon10_Jpsi_Barrel','HLT_Mu7p5_Track2_Jpsi','HLT_Mu7p5_Track3p5_Jpsi','HLT_Mu7p5_Track7_Jpsi','HLT_Dimuon0er16_Jpsi_NoOS_NoVertexing'])

        return self.d